import{_ as i}from"./A07-0-d4442588.js";import{_ as c,V as l,W as u,Y as n,a0 as s,Z as a,X as e,F as p}from"./framework-2236aa4f.js";const r="/ai-guides/imgs/column/springai/D05-1.webp",d="/ai-guides/imgs/column/springai/D05-2.webp",k="/ai-guides/imgs/column/springai/D05-3.webp",v={},m=n("h1",{id:"æˆ‘ç”¨springaiå®ç°äº†ä¸ªã€Œå¾®ä¿¡çº¢åŒ…å°é¢è®¾è®¡agentã€",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#æˆ‘ç”¨springaiå®ç°äº†ä¸ªã€Œå¾®ä¿¡çº¢åŒ…å°é¢è®¾è®¡agentã€","aria-hidden":"true"},"#"),s(" æˆ‘ç”¨SpringAIå®ç°äº†ä¸ªã€Œå¾®ä¿¡çº¢åŒ…å°é¢è®¾è®¡Agentã€")],-1),b=n("p",null,"å¹´åº•æ”¶åˆ°äº†å¾®ä¿¡ç»™å…¬ä¼—å·å…è´¹å‘çš„ä¸€æ³¢çº¢åŒ…å°é¢å…‘æ¢å¡ï¼Œæ­£å¥½ä¸Šæ¬¡åœ¨å­¦ä¹ SpringAIçš„æ—¶å€™ï¼Œçœ‹åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„æœºåˆ¶â€”â€”å¤§æ¨¡å‹çš„å“åº”å‰é—®è¯¢ï¼Œè¿™ä¸æ˜¯å°±æ˜¯ä¸€ä¸ªç»ä½³çš„åº”ç”¨åœºæ™¯å˜›~",-1),g=n("p",null,"è®©AIæ¥æ‰®æ¼”ä¸€ä¸ªè®¾è®¡å¸ˆï¼Œé€šè¿‡ä¸æˆ‘çš„å¯¹è¯æ¥æ•²å®šæˆ‘æƒ³è¦çš„çº¢åŒ…å°é¢ï¼Œç„¶ååŸºäºè¿™ä¸ªè®¾è®¡æ–¹æ¡ˆæ¥ç”Ÿæˆå¯¹åº”çš„çº¢åŒ…å°é¢ï¼Œæ¥ä¸ªä¸€ç«™å¼çš„å¾®ä¿¡çº¢åŒ…å°é¢ç”ŸæˆAgent",-1),h=n("h2",{id:"ä¸€ã€æ•ˆæœä½“éªŒ",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ä¸€ã€æ•ˆæœä½“éªŒ","aria-hidden":"true"},"#"),s(" ä¸€ã€æ•ˆæœä½“éªŒ")],-1),q={href:"https://api.ppai.top/",target:"_blank",rel:"noopener noreferrer"},f=n("p",null,"é»˜è®¤è¿›å…¥ä¹‹åé•¿è¿™æ ·ï¼ˆå‰ç«¯é¡µé¢ç”±Kimiç”Ÿæˆï¼‰,é€šè¿‡ç‚¹å‡»å³å°è§’çš„å¯¹è¯æŒ‰é’®å”¤å‡ºè®¾è®¡æ¡†",-1),w=n("figure",null,[n("img",{src:r,alt:"",tabindex:"0",loading:"lazy"}),n("figcaption")],-1),_=n("p",null,"æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡å¯¹è¯æ¥æ¼”ç¤ºä¸€ä¸‹å…·ä½“çš„æ•ˆæœ",-1),y={href:"https://mp.weixin.qq.com/s/QyuWZ4EZ32pbcWn3fVphHQ",target:"_blank",rel:"noopener noreferrer"},x=e('<h2 id="äºŒã€æ™ºèƒ½çº¢åŒ…å°é¢è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#äºŒã€æ™ºèƒ½çº¢åŒ…å°é¢è®¾è®¡" aria-hidden="true">#</a> äºŒã€æ™ºèƒ½çº¢åŒ…å°é¢è®¾è®¡</h2><h3 id="_2-1-æ•´ä½“ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_2-1-æ•´ä½“ä»‹ç»" aria-hidden="true">#</a> 2.1 æ•´ä½“ä»‹ç»</h3><p>è¿™æ˜¯ä¸€ä¸ªåŸºäºSpring AIå¼€å‘çš„å®Œæ•´åº”ç”¨ï¼Œå®ƒèƒ½è®©AIåƒä¸“ä¸šè®¾è®¡å¸ˆä¸€æ ·ï¼Œé€šè¿‡å¤šè½®å¯¹è¯ç†è§£ä½ çš„éœ€æ±‚ï¼Œç„¶åç›´æ¥ç”Ÿæˆç¬¦åˆè¦æ±‚çš„çº¢åŒ…å°é¢ã€‚æ•´ä¸ªè¿‡ç¨‹å°±åƒå’Œä¸€ä¸ªæ‡‚è®¾è®¡çš„æœ‹å‹èŠå¤©ï¼Œä½ è¯´æƒ³æ³•ï¼Œå®ƒæ¥å®ç°ã€‚</p><p>ç³»ç»Ÿçš„æ ¸å¿ƒäº®ç‚¹æ˜¯&quot;ä¼šæé—®çš„AI&quot;ã€‚å½“ä½ è¯´&quot;å¸®æˆ‘åšä¸ªçº¢åŒ…å°é¢&quot;æ—¶ï¼Œå®ƒä¸ä¼šç›²ç›®çŒœæµ‹ï¼Œè€Œæ˜¯ä¸»åŠ¨è¯¢é—®ï¼š&quot;ä½ æƒ³è¦ä»€ä¹ˆé£æ ¼ï¼Ÿä¼ ç»Ÿå›½é£è¿˜æ˜¯ç°ä»£ç®€çº¦ï¼Ÿ&quot;&quot;ä¸»è‰²è°ƒåå‘çº¢è‰²è¿˜æ˜¯é‡‘è‰²ï¼Ÿ&quot;é€šè¿‡è¿™äº›é—®é¢˜ï¼ŒAIèƒ½å‡†ç¡®æŠŠæ¡ä½ çš„éœ€æ±‚ã€‚</p><h3 id="_2-2-æ¶æ„è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#_2-2-æ¶æ„è®¾è®¡" aria-hidden="true">#</a> 2.2 æ¶æ„è®¾è®¡</h3><p>é¡¹ç›®é‡‡ç”¨äº†ä¸‰å±‚æ¶æ„è®¾è®¡ï¼š</p><ul><li>å¯¹è¯å±‚ï¼šä½¿ç”¨AskUserQuestionToolå·¥å…·ï¼Œè®©AIå…·å¤‡ä¸»åŠ¨æé—®èƒ½åŠ›ã€‚å°±åƒè®¾è®¡å¸ˆä¼šé€šè¿‡æé—®äº†è§£å®¢æˆ·éœ€æ±‚ä¸€æ ·ï¼Œæˆ‘ä»¬çš„AIä¹Ÿä¼šä¸€æ­¥æ­¥æ¾„æ¸…è®¾è®¡è¦æ±‚ã€‚</li><li>ç”Ÿæˆå±‚ï¼šé›†æˆé˜¿é‡Œäº‘åƒé—®çš„æ–‡ç”Ÿå›¾APIï¼Œå°†æ–‡å­—æè¿°è½¬æ¢ä¸ºè§†è§‰å›¾åƒã€‚ç‰¹åˆ«é’ˆå¯¹å¾®ä¿¡çº¢åŒ…å°é¢çš„3x4æ¯”ä¾‹(å¾®ä¿¡çº¢åŒ…å°é¢å°ºå¯¸=957Ã—1278)è¿›è¡Œäº†ä¼˜åŒ–ã€‚</li><li>äº¤äº’å±‚ï¼šé€šè¿‡SSEï¼ˆæœåŠ¡å™¨å‘é€äº‹ä»¶ï¼‰æŠ€æœ¯å®ç°å®æ—¶å¯¹è¯ï¼Œç”¨æˆ·èƒ½çœ‹åˆ°AIæ€è€ƒå’Œå›åº”çš„å®Œæ•´è¿‡ç¨‹ï¼Œä½“éªŒéå¸¸æµç•…ã€‚</li></ul><figure><img src="'+d+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-mermaind line-numbers-mode" data-ext="mermaind"><pre class="language-mermaind"><code>graph TD
    %% ç»Ÿä¸€æ ·å¼å®šä¹‰ï¼ˆä¿ç•™åŸæœ‰ç¾åŒ–ä½“ç³»ï¼Œå¾®è°ƒç»†èŠ‚ï¼‰
    classDef uiLayer fill:#E1F5FE,color:#2D3748,stroke:#0288D1,stroke-width:2px,rx:8,ry:8,font-weight:500
    classDef chatLayer fill:#F3E5F5,color:#2D3748,stroke:#8E24AA,stroke-width:2px,rx:8,ry:8
    classDef prodLayer fill:#E8F5E8,color:#2D3748,stroke:#48BB78,stroke-width:2px,rx:8,ry:8
    classDef interLayer fill:#FFF3E0,color:#2D3748,stroke:#F57C00,stroke-width:2px,rx:8,ry:8
    classDef subNode fill:#FFFFFF,color:#4A5568,stroke:#CBD5E0,stroke-width:1px,rx:6,ry:6
    classDef linkNode fill:#FAFAFA,color:#2D3748,stroke:#718096,stroke-width:1px,rx:6,ry:6,dashed:true

    %% æ ¸å¿ƒå±‚çº§èŠ‚ç‚¹ï¼ˆé¡¶éƒ¨å…¥å£ï¼Œå±…ä¸­ï¼‰
    A[&quot;ğŸ–¥ï¸ ç”¨æˆ·ç•Œé¢å±‚&lt;br/&gt;ï¼ˆç”¨æˆ·äº¤äº’å…¥å£ï¼‰&quot;]:::uiLayer
    


    %% ç¬¬ä¸€å±‚å­å›¾ï¼šå¯¹è¯å±‚ï¼ˆå‚ç›´å¸ƒå±€ç¬¬ä¸€ä¸ªï¼Œå­å›¾å†…å¸ƒå±€è§„æ•´ï¼‰
    subgraph SC[&quot;ğŸ’¬ å¯¹è¯å±‚ - éœ€æ±‚äº¤äº’æ¨¡å—&quot;]
        style SC fill:#F3E5F520,stroke:#8E24AA,stroke-width:1px,rx:8,ry:8
        B[&quot;ğŸ’¬ å¯¹è¯å±‚&lt;br/&gt;ï¼ˆéœ€æ±‚äº¤äº’æ ¸å¿ƒï¼‰&quot;]:::chatLayer
        %% å­èŠ‚ç‚¹å‚ç›´æ’åˆ—åœ¨é¡¶èŠ‚ç‚¹ä¸‹æ–¹ï¼Œç»Ÿä¸€ç¼©è¿›
        B1[&quot;â“ AskUserQuestionTool&lt;br/&gt;ï¼ˆç”¨æˆ·æé—®å·¥å…·ï¼‰&quot;]:::subNode
        B2[&quot;ğŸ”„ å¤šè½®å¯¹è¯ç®¡ç†&lt;br/&gt;ï¼ˆä¸Šä¸‹æ–‡ç»´æŠ¤ï¼‰&quot;]:::subNode
        B3[&quot;ğŸ“ éœ€æ±‚æ¾„æ¸…æœºåˆ¶&lt;br/&gt;ï¼ˆæ„å›¾è¯†åˆ«ï¼‰&quot;]:::subNode
        
        %% å­å›¾å†…éƒ¨å‚ç›´è¿çº¿ï¼ˆè§„æ•´å¯¹é½ï¼‰
        B --&gt; B1
        B1 --&gt; B2
        B2 --&gt; B3
    end

    %% å…³è”èŠ‚ç‚¹ï¼šå›ºå®šåœ¨å¯¹è¯å±‚å³ä¾§ï¼Œé¿å…å¸ƒå±€æ¼‚ç§»
    E[&quot;ğŸ’¬ ChatClient&lt;br/&gt;ï¼ˆå¯¹è¯å®¢æˆ·ç«¯ï¼‰&quot;]:::linkNode

    %% è§†è§‰åˆ†éš”çº¿ï¼ˆåŒºåˆ†ä¸åŒå­å›¾ï¼‰

    %% ç¬¬äºŒå±‚å­å›¾ï¼šç”Ÿäº§å±‚ï¼ˆå‚ç›´å¸ƒå±€ç¬¬äºŒä¸ªï¼Œä¸å¯¹è¯å±‚å¸ƒå±€ä¸€è‡´ï¼‰
    subgraph SA[&quot;ğŸ¨ ç”Ÿäº§å±‚ - å›¾åƒç”Ÿæˆæ¨¡å—&quot;]
        style SA fill:#E8F5E820,stroke:#48BB78,stroke-width:1px,rx:8,ry:8,margin:10px
        %% å­å›¾é¡¶èŠ‚ç‚¹
        C[&quot;ğŸ¨ ç”Ÿäº§å±‚&lt;br/&gt;ï¼ˆå›¾åƒç”Ÿæˆæ ¸å¿ƒï¼‰&quot;]:::prodLayer
        %% å­èŠ‚ç‚¹å‚ç›´æ’åˆ—
        C1[&quot;ğŸ“¡ æ–‡ç”Ÿå›¾APIè°ƒç”¨&lt;br/&gt;ï¼ˆæ¥å£å°è£…ï¼‰&quot;]:::subNode
        C2[&quot;â˜ï¸ é˜¿é‡Œäº‘åƒé—®é›†æˆ&lt;br/&gt;ï¼ˆæ¨¡å‹å¯¹æ¥ï¼‰&quot;]:::subNode
        C3[&quot;âš™ï¸ å›¾åƒç”Ÿæˆå¼•æ“&lt;br/&gt;ï¼ˆæ ¸å¿ƒç”Ÿæˆé€»è¾‘ï¼‰&quot;]:::subNode
        C4[&quot;âœ… è´¨é‡æ§åˆ¶æ¨¡å—&lt;br/&gt;ï¼ˆæ•ˆæœæ ¡éªŒï¼‰&quot;]:::subNode
        
        %% å­å›¾å†…éƒ¨å‚ç›´è¿çº¿
        C --&gt; C1
        C1 --&gt; C2
        C2 --&gt; C3
        C3 --&gt; C4
    end

    %% å…³è”èŠ‚ç‚¹ï¼šå›ºå®šåœ¨ç”Ÿäº§å±‚å³ä¾§
    F[&quot;ğŸ¨ QwenImgGen&lt;br/&gt;ï¼ˆåƒé—®å›¾åƒç”Ÿæˆå™¨ï¼‰&quot;]:::linkNode

    %% è§†è§‰åˆ†éš”çº¿

    %% ç¬¬ä¸‰å±‚å­å›¾ï¼šäº¤äº’å±‚ï¼ˆå‚ç›´å¸ƒå±€ç¬¬ä¸‰ä¸ªï¼Œå¸ƒå±€ç»Ÿä¸€ï¼‰
    subgraph SB[&quot;ğŸ”Œ äº¤äº’å±‚ - å®æ—¶é€šä¿¡æ¨¡å—&quot;]
        style SB fill:#FFF3E020,stroke:#F57C00,stroke-width:1px,rx:8,ry:8,margin:10px
        %% å­å›¾é¡¶èŠ‚ç‚¹
        D[&quot;ğŸ”Œ äº¤äº’å±‚&lt;br/&gt;ï¼ˆå®æ—¶é€šä¿¡æ”¯æ’‘ï¼‰&quot;]:::interLayer
        %% å­èŠ‚ç‚¹å‚ç›´æ’åˆ—
        D1[&quot;ğŸ“¢ SSEå®æ—¶é€šä¿¡&lt;br/&gt;ï¼ˆæœåŠ¡ç«¯æ¨é€ï¼‰&quot;]:::subNode
        D2[&quot;ğŸ“Š æµå¼å“åº”å¤„ç†&lt;br/&gt;ï¼ˆåˆ†æ®µè§£æï¼‰&quot;]:::subNode
        D3[&quot;ğŸ”„ å‰ç«¯çŠ¶æ€åŒæ­¥&lt;br/&gt;ï¼ˆæ•°æ®æ›´æ–°ï¼‰&quot;]:::subNode
        D4[&quot;âœ¨ ç”¨æˆ·ä½“éªŒä¼˜åŒ–&lt;br/&gt;ï¼ˆåŠ è½½/åé¦ˆï¼‰&quot;]:::subNode
        
        %% å­å›¾å†…éƒ¨å‚ç›´è¿çº¿
        D --&gt; D1
        D1 --&gt; D2
        D2 --&gt; D3
        D3 --&gt; D4
    end

    %% å…³è”èŠ‚ç‚¹ï¼šå›ºå®šåœ¨äº¤äº’å±‚å³ä¾§
    G[&quot;ğŸ”Œ WebSocket/SSE&lt;br/&gt;ï¼ˆé€šä¿¡åè®®ï¼‰&quot;]:::linkNode

    %% æ ¸å¿ƒå±‚çº§å‚ç›´è¿çº¿ï¼ˆé¡¶å±‚â†’å„å­å›¾å±‚çº§æ ¸å¿ƒï¼Œè§†è§‰å¼•å¯¼æ¸…æ™°ï¼‰
    A --&gt; B
    B --&gt; C
    C --&gt; D

    %% è™šçº¿å…³è”ï¼ˆå­å›¾å±‚çº§æ ¸å¿ƒâ†’å¯¹åº”å…³è”èŠ‚ç‚¹ï¼Œè¿çº¿æ›´çŸ­æ›´è§„æ•´ï¼‰
    B -.-&gt; E
    C -.-&gt; F
    D -.-&gt; G
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä¸‰ã€æ ¸å¿ƒå®ç°" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€æ ¸å¿ƒå®ç°" aria-hidden="true">#</a> ä¸‰ã€æ ¸å¿ƒå®ç°</h2>`,10),I={href:"https://mp.weixin.qq.com/s/LcvmiIERs6aOIlRAKGGnFg",target:"_blank",rel:"noopener noreferrer"},A=e('<h3 id="_3-1-å¤šè½®é—®è¯¢æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#_3-1-å¤šè½®é—®è¯¢æœºåˆ¶" aria-hidden="true">#</a> 3.1 å¤šè½®é—®è¯¢æœºåˆ¶</h3><p>å¦‚ä½•è¯†åˆ«ç”¨æˆ·çš„æ„å›¾ï¼Ÿè¿™å¥½åƒæ˜¯æ¯ä¸ªAgentå¼€å‘å¿…é¡»è§£å†³çš„é—®é¢˜ï¼Œè¿™é‡Œå¯ä»¥è¯´æ˜¯ç»™å‡ºäº†ä¸€ä¸ªç»å…¸çš„è§£å†³æ–¹æ¡ˆï¼Œé‚£å°±æ˜¯ä¸»åŠ¨é—®è¯¢ï¼Œè®©ç”¨æˆ·ä¸»åŠ¨è¿›è¡Œæ¾„æ¸…ï¼Œè¿™é‡Œçš„ä¸»è¦å®ç°åŸç†å¦‚ä¸‹å›¾</p><figure><img src="'+i+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>è¿™ä¸€å¥—è®¾è®¡å“²å­¦éµå¾ªé—®ç­”å¼å·¥ä½œæµç¨‹ï¼š</p><ol><li>AIç”Ÿæˆé—®é¢˜ <ul><li>æ™ºèƒ½ä½“åˆ¤æ–­éœ€è¦è¾“å…¥å¹¶æ„å»ºé—®é¢˜ï¼ˆæ¯ä¸ªé—®é¢˜åŒ…å«é—®é¢˜æ–‡æœ¬ã€æ ‡é¢˜ã€2-4ä¸ªé€‰é¡¹å’Œå¤šé€‰æ ‡å¿—ï¼‰ï¼Œç„¶åè°ƒç”¨<code>AskUserQuestionTool</code>å‡½æ•°</li></ul></li><li>ç”¨æˆ·æä¾›ç­”æ¡ˆ <ul><li>ç”±ä¸šåŠ¡ä»£ç å®ç°æ¥æ”¶è¿™äº›é—®é¢˜ï¼Œç„¶åé€šè¿‡åˆé€‚çš„å½¢å¼ï¼ˆæ§åˆ¶å°/webé¡µé¢ç­‰ï¼‰å±•ç¤ºç»™ç”¨æˆ·ï¼Œç„¶åæ”¶é›†ç”¨æˆ·çš„å›ç­”ï¼Œå¹¶å°†ç­”æ¡ˆè¿”å›ç»™LLMã€‚</li></ul></li><li>æå‡ºæ›´å¤šé—®é¢˜ <ul><li>å¦‚æœ‰å¿…è¦ï¼Œé‡å¤æ­¥éª¤1ã€2ï¼Œä»¥æ”¶é›†æ›´å¤šç”¨æˆ·åé¦ˆ</li></ul></li><li>äººå·¥æ™ºèƒ½æŒç»­å…³æ³¨ä¸Šä¸‹æ–‡ <ul><li>LLMåˆ©ç”¨è¿™äº›ç­”æ¡ˆæ¥æä¾›é‡èº«å®šåˆ¶çš„è§£å†³æ–¹æ¡ˆ</li></ul></li></ol><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œæ¯ä¸ªé—®é¢˜çš„å›ç­”å¹¶ä¸æ˜¯å†™æ­»çš„ï¼š</p><ul><li>æ”¯æŒå•é€‰æˆ–å¤šé€‰: é€‰æ‹©ä¸€ä¸ªé€‰é¡¹æˆ–ç»„åˆå¤šä¸ªé€‰é¡¹</li><li>æ”¯æŒé€‰é¡¹å¤–çš„æ–‡æœ¬è¾“å…¥: ç”¨æˆ·å¯ä»¥éšæ—¶æä¾›è¶…å‡ºé¢„å®šä¹‰é€‰é¡¹èŒƒå›´çš„è‡ªå®šä¹‰æ–‡æœ¬</li><li>ä¸°å¯Œçš„ä¸Šä¸‹æ–‡: æ¯ä¸ªé€‰é¡¹éƒ½åŒ…å«ä¸€ä¸ªæè¿°ï¼Œè§£é‡Šå…¶å«ä¹‰å’Œæƒè¡¡</li></ul><h3 id="_3-2-webäº¤äº’æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#_3-2-webäº¤äº’æ–¹æ¡ˆ" aria-hidden="true">#</a> 3.2 WEBäº¤äº’æ–¹æ¡ˆ</h3><p>å¯¹äºwebå±‚çš„ç”¨æˆ·äº¤äº’ï¼Œæˆ‘ä»¬é‡‡ç”¨SSEçš„äº¤äº’æ–¹å¼ï¼Œå…·ä½“æµç¨‹æ˜¯</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ç”¨æˆ·å¼€å¯ä¼šè¯ï¼Œè¾“å…¥ç¬¬ä¸€æ¬¡è®¾è®¡è¦æ±‚
	â¬‡ï¸
åç«¯å»ºç«‹SSEé“¾æ¥ï¼Œå¹¶é€šè¿‡å¼‚æ­¥æ–¹å¼å°†è®¾è®¡è¦æ±‚å‘é€ç»™LLMï¼Œ
	â¬‡ï¸
å¤§æ¨¡å‹è¿”å›é—®è¯¢å†…å®¹
	â¬‡ï¸
åç«¯é€æ¡å°†é—®è¯¢å†…å®¹é€šè¿‡SSEå‘é€ç»™ç”¨æˆ·
	â¬‡ï¸
ç”¨æˆ·å›ç­”å†…å®¹ï¼Œé€šè¿‡send/{chatId}å‘é€ç»™åç«¯
	â¬‡ï¸
é—®è¯¢ç»“æŸï¼Œåç«¯ç»„è£…å›ç­”å‘é€ç»™LLM
	â¬‡ï¸
LLMè¿”å›å®Œæ•´è®¾è®¡æ–¹æ¡ˆ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥æ—¶åºå›¾çš„è§†è§’æ¥çœ‹ä¸€ä¸‹å®Œæ•´çš„äº¤äº’æ–¹æ¡ˆ</p><figure><img src="`+k+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>',12),S=e(`<p>åœ¨è¿™å¥—æ–¹æ¡ˆçš„å…·ä½“å®ç°ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¸Šä¸‹æ–‡æ¥æŒæœ‰ <code>ä¼šè¯ä¸SSE</code> ä¹‹é—´çš„å…³ç³»ï¼Œè¿™æ ·æ‰å¯ä»¥å°†ç”¨æˆ·çš„å›ç­”å†…å®¹ä¸ä¹‹å‰çš„å¤§æ¨¡å‹ä¼šè¯è¿›è¡Œç»‘å®š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReqContextHolder</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ReqInfo</span><span class="token punctuation">&gt;</span></span> reqId <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InheritableThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setReqId</span><span class="token punctuation">(</span><span class="token class-name">ReqInfo</span> reqId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ReqContextHolder</span><span class="token punctuation">.</span>reqId<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>reqId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ReqInfo</span> <span class="token function">getReqId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> reqId<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        reqId<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">record</span> <span class="token class-name">ReqInfo</span><span class="token punctuation">(</span><span class="token class-name">String</span> chatId<span class="token punctuation">,</span> <span class="token class-name">SseEmitter</span> sse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä¸€ä¸ªä¸´æ—¶çš„Mapæ¥å­˜å‚¨ç”¨æˆ·çš„é—®è¯¢ç»“æœï¼Œè¿™é‡Œå€ŸåŠ©<code>BlockingQueue</code>æ¥å®ç°ä¸€ä¸ªç®€æ˜“çš„æ¶ˆæ¯é©±åŠ¨æ¨¡å¼</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">BlockingQueue</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> chatHistory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åŸºäºä¸Šé¢è¿™ä¸¤ä¸ªä¸­é—´å­˜å‚¨ç®¡é“ï¼Œæ‰€ä»¥æˆ‘ä»¬æ ¸å¿ƒçš„é—®è¯¢å›è°ƒ<code>WebQuestionHandler</code>çš„å…·ä½“å®ç°å¦‚ä¸‹ (ä¸‹é¢çš„å®ç°ç»™äº†å®Œæ•´çš„æ³¨é‡Šï¼Œåº”è¯¥ä¸éš¾ç†è§£ğŸ˜Š)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebQuestionHandler</span> <span class="token keyword">implements</span> <span class="token class-name">AskUserQuestionTool<span class="token punctuation">.</span>QuestionHandler</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token doc-comment comment">/**
         * å¤„ç†ç”¨æˆ·é—®é¢˜åˆ—è¡¨ï¼Œå‘ç”¨æˆ·å‘é€é—®é¢˜å¹¶ç­‰å¾…ç”¨æˆ·å›ç­”
         *
         * <span class="token keyword">@param</span> <span class="token parameter">questions</span> ç”¨æˆ·é—®é¢˜åˆ—è¡¨
         * <span class="token keyword">@return</span> åŒ…å«é—®é¢˜å’Œå¯¹åº”ç­”æ¡ˆçš„æ˜ å°„
         */</span>
        <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AskUserQuestionTool<span class="token punctuation">.</span>Question</span><span class="token punctuation">&gt;</span></span> questions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// åˆ›å»ºç”¨äºå­˜å‚¨é—®é¢˜å’Œç­”æ¡ˆçš„æ˜ å°„</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> answers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è·å–å½“å‰è¯·æ±‚çš„ä¸Šä¸‹æ–‡ä¿¡æ¯</span>
            <span class="token class-name">ReqContextHolder<span class="token punctuation">.</span>ReqInfo</span> req <span class="token operator">=</span> <span class="token class-name">ReqContextHolder</span><span class="token punctuation">.</span><span class="token function">getReqId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è·å–SSEå‘å°„å™¨ç”¨äºå‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯</span>
            <span class="token class-name">SseEmitter</span> sseEmitter <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">sse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// éå†æ‰€æœ‰éœ€è¦è¯¢é—®ç”¨æˆ·çš„é—®é¢˜</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">AskUserQuestionTool<span class="token punctuation">.</span>Question</span> q <span class="token operator">:</span> questions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// å‘ç”¨æˆ·å‘é€é—®é¢˜æ ‡é¢˜å’Œå†…å®¹</span>
                <span class="token function">sendMsg</span><span class="token punctuation">(</span>sseEmitter<span class="token punctuation">,</span> <span class="token string">&quot;\\n&quot;</span> <span class="token operator">+</span> q<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> q<span class="token punctuation">.</span><span class="token function">question</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// è·å–é—®é¢˜çš„é€‰é¡¹åˆ—è¡¨</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AskUserQuestionTool<span class="token punctuation">.</span>Question<span class="token punctuation">.</span>Option</span><span class="token punctuation">&gt;</span></span> options <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// éå†é€‰é¡¹å¹¶å‘é€ç»™ç”¨æˆ·</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> options<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">AskUserQuestionTool<span class="token punctuation">.</span>Question<span class="token punctuation">.</span>Option</span> opt <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">sendMsg</span><span class="token punctuation">(</span>sseEmitter<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;  %d. %s - %s%n&quot;</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> opt<span class="token punctuation">.</span><span class="token function">label</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> opt<span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// æ ¹æ®æ˜¯å¦æ”¯æŒå¤šé€‰å‘é€ä¸åŒçš„æç¤ºä¿¡æ¯</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">multiSelect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">sendMsg</span><span class="token punctuation">(</span>sseEmitter<span class="token punctuation">,</span> <span class="token string">&quot;  (Enter numbers separated by commas, or type custom text)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token function">sendMsg</span><span class="token punctuation">(</span>sseEmitter<span class="token punctuation">,</span> <span class="token string">&quot;  (Enter a number, or type custom text)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// é˜»å¡ç­‰å¾…ç”¨æˆ·è¾“å…¥</span>
                <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> queue <span class="token operator">=</span> chatHistory<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">chatId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// å¦‚æœé˜Ÿåˆ—ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–°çš„é˜Ÿåˆ—</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>queue <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    chatHistory<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">chatId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> queue<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                
                <span class="token class-name">String</span> response <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token comment">// ç­‰å¾…æœ€å¤š5åˆ†é’Ÿè·å–ç”¨æˆ·å“åº”ï¼Œè¶…æ—¶åˆ™è¿”å›ç©ºå­—ç¬¦ä¸²</span>
                    response <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MINUTES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>response <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        response <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> <span class="token comment">// è¶…æ—¶æƒ…å†µä¸‹çš„é»˜è®¤å“åº”</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// çº¿ç¨‹è¢«ä¸­æ–­æ—¶è®¾ç½®ä¸­æ–­çŠ¶æ€å¹¶è¿”å›ç©ºå­—ç¬¦ä¸²</span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    response <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// è§£æç”¨æˆ·å“åº”å¹¶å­˜å…¥ç­”æ¡ˆæ˜ å°„</span>
                answers<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">question</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">parseResponse</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// è¿”å›åŒ…å«æ‰€æœ‰é—®é¢˜å’Œç­”æ¡ˆçš„æ˜ å°„</span>
            <span class="token keyword">return</span> answers<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">sendMsg</span><span class="token punctuation">(</span><span class="token class-name">SseEmitter</span> sseEmitter<span class="token punctuation">,</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                sseEmitter<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-å›¾ç‰‡ç”Ÿæˆ" tabindex="-1"><a class="header-anchor" href="#_3-3-å›¾ç‰‡ç”Ÿæˆ" aria-hidden="true">#</a> 3.3 å›¾ç‰‡ç”Ÿæˆ</h3><p>å›¾æ–‡ç”Ÿæˆæˆ‘ä»¬è¿™é‡Œç»™å‡ºäº†ä¸¤ç§ï¼Œä¸€ä¸ªæ˜¯åŸºäºæ™ºè°±çš„ä¸€ä¸ªæ˜¯åŸºäºåƒé—®çš„(å› ä¸ºæ™ºè°±çš„å…è´¹æ¨¡å‹æœ‰ç‚¹æ‹‰è·¨)ï¼›</p><p>æ–‡ç”Ÿå›¾çš„å…·ä½“å®ç°æ²¡æœ‰å¤ªå¤šå¥½è¯´çš„ï¼Œè¿™é‡Œå•ç‹¬æŒ‡å‡ºæ¥æ˜¯æƒ³æé†’ï¼Œè¿™é‡Œå®é™…ä¸Šè¿˜å¯ä»¥ç»§ç»­æ‰©å±•ä¸€ä¸‹ï¼Œé™¤äº†ç”Ÿæˆé™æ€å›¾ç‰‡ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è€ƒè™‘æ”¯æŒç”ŸæˆåŠ¨æ€çš„è§†é¢‘ï¼›é™¤äº†ç”Ÿæˆå°é¢å›¾ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è€ƒè™‘æ‰©å±•ç”ŸæˆæŒ‚ä»¶</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;/genImg&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">genImg</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>environment<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;spring.ai.dashboard.enable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">QwenImgGen</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>environment<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;spring.ai.dashboard.api-key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿™é‡Œä½¿ç”¨çš„æ˜¯æ™ºè°±çš„æ–‡ç”Ÿå›¾æ¨¡å‹ï¼Œæ•ˆæœè¾ƒå·®</span>
        <span class="token class-name">ImageResponse</span> response <span class="token operator">=</span> imgModel<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ImagePrompt</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span>
                <span class="token class-name">ImageOptionsBuilder</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">1344</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token number">768</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&quot;CogView-3-Flash&quot;</span><span class="token punctuation">)</span>
                        <span class="token comment">// è¿”å›å›¾ç‰‡ç±»å‹</span>
                        <span class="token punctuation">.</span><span class="token function">responseFormat</span><span class="token punctuation">(</span><span class="token string">&quot;png&quot;</span><span class="token punctuation">)</span>
                        <span class="token comment">// å›¾åƒé£æ ¼ï¼Œå¦‚ vivid ç”ŸåŠ¨é£æ ¼ï¼Œ natural è‡ªç„¶é£æ ¼</span>
                        <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&quot;natural&quot;</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Image</span> img <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BufferedImage</span> image <span class="token operator">=</span> <span class="token class-name">ImageIO</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span><span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å°†å›¾ç‰‡è½¬æ¢ä¸ºBase64ç¼–ç </span>
        <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ImageIO</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token string">&quot;png&quot;</span><span class="token punctuation">,</span> baos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> imageBytes <span class="token operator">=</span> baos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>imageBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å››ã€å°ç»“" tabindex="-1"><a class="header-anchor" href="#å››ã€å°ç»“" aria-hidden="true">#</a> å››ã€å°ç»“</h2><p>è¿™ä¸€ç¯‡å†…å®¹å¯ä»¥è¯´æ˜¯ä¸Šä¸€ç¯‡SpringAIæ™ºèƒ½ä½“è®¾è®¡ä¸­é—®è¯¢æœºåˆ¶çš„å…·ä½“ä½¿ç”¨åœºæ™¯ï¼Œæ•´ä¸ªç³»ç»Ÿå±•ç°äº†AIåº”ç”¨å¼€å‘çš„æ–°æ€è·¯ï¼šä¸æ˜¯è®©äººé€‚åº”æœºå™¨ï¼Œè€Œæ˜¯è®©æœºå™¨ç†è§£äººçš„è¡¨è¾¾æ–¹å¼ã€‚é€šè¿‡å¤šè½®å¯¹è¯è·å–å‡†ç¡®éœ€æ±‚ï¼Œå†é€šè¿‡AIç”Ÿæˆèƒ½åŠ›ç›´æ¥äº§ç”Ÿæˆæœï¼ŒçœŸæ­£å®ç°äº†ä»æƒ³æ³•åˆ°ä½œå“çš„è½¬æ¢ã€‚å½“ç„¶æ•´ä½“çš„å®ç°è¿˜æ¯”è¾ƒåˆçº§ï¼Œè¿˜æœ‰ä¸å°‘çš„æŒ–æ˜ç©ºé—´ï¼Œæ¯”å¦‚ä¸€æ¬¡ç”Ÿæˆå®Œæ•´çš„å¾®ä¿¡çº¢åŒ…æ–¹æ¡ˆï¼ˆåŒ…æ‹¬å°é¢ç®€ç§°ã€å°é¢å›¾ã€æŒ‚ä»¶ã€æ°”æ³¡æŒ‚ä»¶ã€å°é¢æ•…äº‹ç­‰ï¼‰æ¬¢è¿æœ‰å…´è¶£çš„å°ä¼™ä¼´è¿›è¡Œè¡¥å…¨</p><p>é¡¹ç›®æºç ï¼š</p>`,13),E={href:"https://github.com/liuyueyi/spring-ai-demo/tree/master/v2/T03-manual-qa-web-robot",target:"_blank",rel:"noopener noreferrer"},L=n("p",null,"é›¶åŸºç¡€å…¥é—¨ï¼š",-1),N={href:"https://mp.weixin.qq.com/s/qCn8x2XO2shA8MheYbHq0w",target:"_blank",rel:"noopener noreferrer"},F={href:"https://mp.weixin.qq.com/s/2GXBNOUq3jlysipftz8TpA",target:"_blank",rel:"noopener noreferrer"},C={href:"https://mp.weixin.qq.com/s/v-z6EHY300ElOxdGPdzc0w",target:"_blank",rel:"noopener noreferrer"},B={href:"https://mp.weixin.qq.com/s/t_BuAW9i0npcaJdua3Am2Q",target:"_blank",rel:"noopener noreferrer"},D={href:"https://mp.weixin.qq.com/s/vzt0bGwcfnASOiBa0Kc7VQ",target:"_blank",rel:"noopener noreferrer"},Q={href:"https://mp.weixin.qq.com/s/Nk-N34TLJVCTI5F4k5rGaQ",target:"_blank",rel:"noopener noreferrer"},T={href:"https://mp.weixin.qq.com/s/ZQbztqBq7_PzynG06N4-mg",target:"_blank",rel:"noopener noreferrer"},j={href:"https://mp.weixin.qq.com/s/nnKspRO87xbrn4-LBV3RNA",target:"_blank",rel:"noopener noreferrer"},M={href:"https://mp.weixin.qq.com/s/_5D2tF6CPnafj5mlmlwLNw",target:"_blank",rel:"noopener noreferrer"},R={href:"https://mp.weixin.qq.com/s/z5qaLtjChsvjhWNs8Nw05Q",target:"_blank",rel:"noopener noreferrer"},P=n("hr",null,null,-1),O=n("p",null,"å®æˆ˜",-1),H={href:"https://mp.weixin.qq.com/s/96rHyp_gBUgmA2dhSbzNww",target:"_blank",rel:"noopener noreferrer"},U={href:"https://mp.weixin.qq.com/s/SnXdTB6tYqAzG7HgbnTSAQ",target:"_blank",rel:"noopener noreferrer"},z={href:"https://mp.weixin.qq.com/s/NHqLJbos-_nrxNNmhg7IBQ",target:"_blank",rel:"noopener noreferrer"},V={href:"https://mp.weixin.qq.com/s/ujxVleNhjxzUgL-rjfFcVA",target:"_blank",rel:"noopener noreferrer"},G={href:"https://mp.weixin.qq.com/s/LcvmiIERs6aOIlRAKGGnFg",target:"_blank",rel:"noopener noreferrer"};function W(X,Z){const t=p("ExternalLinkIcon"),o=p("Mermaid");return l(),u("div",null,[m,b,g,h,n("p",null,[s("çº¿ä¸Šä½“éªŒåœ°å€ï¼š "),n("a",q,[s("https://api.ppai.top/"),a(t)])]),f,w,_,n("blockquote",null,[n("p",null,[s("å…¬ä¼—å·æŸ¥çœ‹ï¼š "),n("a",y,[s("æˆ‘ç”¨SpringAIå®ç°äº†ä¸ªã€Œå¾®ä¿¡çº¢åŒ…å°é¢è®¾è®¡Agentã€ | ä¸€ç°ç°blog"),a(t)])])]),x,n("p",null,[s("æ•´ä½“çš„å®ç°æ€è·¯åŸºæœ¬ä¸Šå’Œä¸Šä¸€ç¯‡éå¸¸ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯æ”¹äº†äº¤äº’åƒæ˜¯ï¼Œä»æ§åˆ¶å°æ¨¡å¼æ”¹æˆäº†webæ–¹å¼ï¼Œå…·ä½“ç»†èŠ‚è¯·æŸ¥çœ‹ "),n("a",I,[s("Spring AIä¸­çš„å¤šè½®å¯¹è¯è‰ºæœ¯ï¼šè®©å¤§æ¨¡å‹ä¸»åŠ¨æé—®è·å–æ˜ç¡®éœ€æ±‚"),a(t)]),s(" æ¥ä¸‹æ¥å°†ä¸»è¦ä»‹ç»ä¸€äº›æ ¸å¿ƒçš„æŠ€æœ¯ç‚¹")]),A,a(o,{id:"mermaid-169",code:"eJytVl1v02YUvu+v8A0TiNFqwHaBtk6FMVSJSZtgP8BLrRKRJlnicYOQTEtIUvLZhjRLaZt06RINxQnbKGnjhv8ycl7bV+En7NjHdp3YlCI1V7Hfc55znud8vI4Lv/4mhAPCd0F+McYvTU1x+Dt3jrs8zUF+edjLaVIC5OrwID1SUuxNH1ZrWqeNj7A5YLXkSMkMlQpkylA8gkIWXj1XG4cjJW3CRPmYGAwEo3xY5H6OCzGOj3Pvd5rF/6Ts+521PqeWWiz1xmP6fSwSFoXwApmX90a9PAfprPqycz4mLET5wH1BnL4nLoUueFyvG4e2ZynDQSFnuN24x4tz0eANxI1FQiEh5vW8ffsH8mqUOWg0WasO2888VvNLi7eEMBnmWhxqACt5tbTDUgX2Igur9SlHwCvTnF7ZZ/LrL0ZKVa+/1rd2IbUFzWcolmkTjogCF3mAshjafG6zvobQ65mP+Boel2ZnLx47sfQ6KJJ6uAuZhCYPNLlOfqa5bYYuxx4OIhliJYkIlDrDnhRAyeYXsOZDpap1trDUWuepXdgFgQ+IwQc8ErDxHN5Xbd6XjdxfSOzVMssXhocN7CVoVLUjmQ2esF7CTwMswhj9SQjuM6zNBIRXCm2wDok9SwTTGw72IV/UpceTaly0GuYad+vmXW6GjwZnDOIzD4n+o29xOOJiMBL+5iE1q74h67uVR1//EpuZfScVKC13qHdS0QxiARsxTFagLLP2ntZdQRynv1BerfkH2y6Qry0vOlxCRyc3rfknpj8Xv29w/cnK6G4kEsIMLHlMPTA5rbNrZ+AqEgKaryYyO5bszp2bLNdCgQiCWCI6yNtsY5+OsEHYRg3jqe00DBI+YSxk87W3QZwEXPobhLB3KwPcGu7Qav9313KwSuxq3c1ttV0i01OUNI6PxyVdii/a1UQQVk9NVJO0pCMfkmN8fKn717/71B1zqNSQ4/iiweGh7iYlYPCXmuuYE2gsWPZPS0+uGkWo5NS6rEt9bVC0OyYUiURtZ1dDICd1819Ida2XpqfNya/TIN/RVo60tyVUmJW7avUJ5WI0an0PEonxRv1oOyEGATjmHyi+1/ADRT8R0cXDmHaDgam2T7JmUbAKurQ2bjZWRc8kkjI4A/0UTT0rH6CncTeWk9DeUNP437MkTz9/XuizHbJPSNqz2b+0N/sVXMt00+AFqKaTdG/4LXS6L8d2+gnO3lWuLh9Asm/dS6Y5y6T1NfkUQ78ohDE6TbubtTPttFXdSZzJtNuUrVXv+kKY+3Eew1LPuTPC7yz2vGsHJ3+friMQHElK+fx1Pi58dZXVFFDyF4xdXXhJJ8PDjPZ2E1L7iMqyzry7WFGMk1uSghKiFcqEO7N+7P3NdtbxZqbGdNhZvdF9bH+8+FXjf0pzF70="}),S,n("ul",null,[n("li",null,[n("a",E,[s("https://github.com/liuyueyi/spring-ai-demo/tree/master/v2/T03-manual-qa-web-robot"),a(t)])])]),L,n("ul",null,[n("li",null,[n("a",N,[s("LLM åº”ç”¨å¼€å‘æ˜¯ä»€ä¹ˆï¼šé›¶åŸºç¡€ä¹Ÿå¯ä»¥è¯»æ‡‚çš„ç§‘æ™®æ–‡(æç®€ç‰ˆ)"),a(t)])]),n("li",null,[n("a",F,[s("å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šåº-ä¸ºä»€ä¹ˆä½ â€œä¼šç”¨ LLMâ€ï¼Œä½†åšä¸å‡ºå¤æ‚åº”ç”¨ï¼Ÿ"),a(t)])]),n("li",null,[n("a",C,[s("å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬ä¸€ç«  LLMåˆ°åº•åœ¨åšä»€ä¹ˆï¼Ÿ"),a(t)])]),n("li",null,[n("a",B,[s("å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬äºŒç«  æ¨¡å‹ä¸æ˜¯é‡ç‚¹ï¼Œå‚æ•°æ‰æ˜¯ä½ çœŸæ­£çš„æ§åˆ¶é¢æ¿"),a(t)])]),n("li",null,[n("a",D,[s("å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬ä¸‰ç«  ä¸ºä»€ä¹ˆæˆ‘çš„Promptè¡¨ç°å¾ˆç³Ÿï¼Ÿ"),a(t)])]),n("li",null,[n("a",Q,[s("å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬å››ç«  Prompt çš„å·¥ç¨‹åŒ–ç»“æ„è®¾è®¡"),a(t)])]),n("li",null,[n("a",T,[s("å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬äº”ç«  ä» Prompt åˆ° Prompt æ¨¡æ¿ä¸å·¥ç¨‹æ²»ç†"),a(t)])]),n("li",null,[n("a",j,[s("å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬å…­ç«  ä¸Šä¸‹æ–‡çª—å£çš„çœŸå®è¾¹ç•Œ"),a(t)])]),n("li",null,[n("a",M,[s("å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬ä¸ƒç«  ä» â€œå †ä¸Šä¸‹æ–‡â€ åˆ° â€œç®¡ç†ä¸Šä¸‹æ–‡â€"),a(t)])]),n("li",null,[n("a",R,[s("å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬å…«ç«  è®°å¿†ç­–ç•¥çš„å·¥ç¨‹åŒ–é€‰æ‹©"),a(t)])])]),P,O,n("ul",null,[n("li",null,[n("a",H,[s("å®æˆ˜ | ä¸¤ç™¾è¡Œå®ç°ä¸€ä¸ªè‡ªç„¶è¯­è¨€åœ°å€æå–æ™ºèƒ½ä½“"),a(t)])]),n("li",null,[n("a",U,[s("å®æˆ˜ | åŸºäºSpringAIä¸å¤§æ¨¡å‹çš„é›¶é…ç½®å‘ç¥¨æ™ºèƒ½æå–æ¶æ„"),a(t)])]),n("li",null,[n("a",z,[s("å®æˆ˜ | é›¶åŸºç¡€æ­å»ºçŸ¥è¯†åº“é—®ç­”æœºå™¨äººï¼šåŸºäºSpringAI+RAGçš„å®Œæ•´å®ç°"),a(t)])]),n("li",null,[n("a",V,[s("å‘Šåˆ«ä¼ ç»ŸAIå¼€å‘ï¼SpringAI Agent + Skillsé‡æ–°å®šä¹‰æ™ºèƒ½åº”ç”¨"),a(t)])]),n("li",null,[n("a",G,[s("Spring AIä¸­çš„å¤šè½®å¯¹è¯è‰ºæœ¯ï¼šè®©å¤§æ¨¡å‹ä¸»åŠ¨æé—®è·å–æ˜ç¡®éœ€æ±‚"),a(t)])])])])}const K=c(v,[["render",W],["__file","D05.è®¾è®¡ä¸€ä¸ªå¾®ä¿¡çº¢åŒ…ç”ŸæˆAgent.html.vue"]]);export{K as default};
